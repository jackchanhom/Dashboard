<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#0f172a" />
    <meta name="color-scheme" content="dark" />
    <title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á 2566 (‡∏à‡∏≥‡∏•‡∏≠‡∏á)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script>
      // Cache-busting: Load CSS with timestamp to always get fresh version
      const cacheBuster = Date.now();
      document.write('<link rel="stylesheet" href="styles.css?v=' + cacheBuster + '">');
    </script>
  </head>
  <body>
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <h2 class="loading-title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>
        <p class="loading-status" id="loadingStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets...</p>
        <div class="loading-progress">
          <div class="loading-progress__bar" id="loadingProgressBar"></div>
        </div>
        <p class="loading-substatus" id="loadingSubstatus"></p>
      </div>
    </div>

    <header class="topbar">
      <div class="brand">
        <h1>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á 2569</h1>
        <p>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</p>
        <span class="brand-credit">by Jack Chanhom</span>
      </div>
      <div class="topbar__meta">
        <div class="meta-card">
          <span class="meta-label">‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡∏ï</span>
          <strong id="countedTotal">0</strong>
          <small>‡πÄ‡∏Ç‡∏ï</small>
        </div>
        <div class="meta-card">
          <span class="meta-label">‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</span>
          <strong id="partyListSeatsTotal">0</strong>
          <small>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</small>
        </div>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab active" data-tab="overview">‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</button>
      <button class="tab" data-tab="districts">‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï</button>
      <button class="tab" data-tab="partylist">‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</button>
      <button class="tab" data-tab="coalition">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•</button>
      <button class="tab" data-tab="input">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </nav>

    <main class="container">
      <section class="panel active" id="overview">
        <div class="grid">
          <div class="card span-2">
            <div class="card__header">
              <h2>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</h2>
              <p>‡∏ß‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏∂‡∏á‡∏û‡∏£‡∏£‡∏Ñ</p>
            </div>
            <label class="toggle overview-toggle">
              <input type="checkbox" id="includePartyList" checked />
              <span>‡∏£‡∏ß‡∏° ‡∏™.‡∏™.‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</span>
            </label>
            <div class="party-list" id="partyOverview"></div>
          </div>
          <div class="card">
            <div class="card__header">
              <h2>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏û‡∏£‡∏£‡∏Ñ</h2>
              <div class="split-legend">
                <span class="legend-item"><span class="legend-color" style="background:var(--accent-emerald)"></span>‡∏™.‡∏™.‡πÄ‡∏Ç‡∏ï</span>
                <span class="legend-item"><span class="legend-color" style="background:var(--bg-primary);border:1px solid var(--border-color)"></span>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</span>
              </div>
            </div>
            <ol class="rank-list" id="topPartyList"></ol>
          </div>
        </div>
      </section>

      <section class="panel" id="districts">
        <div class="grid">
          <div class="card span-2">
            <div class="card__header">
              <h2>‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏ï‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</h2>
              <p>‡∏ß‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏Ç‡∏ï‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏á</p>
            </div>
            <div class="thai-map">
              <div class="map-zoom">
                <button id="zoomIn" type="button">+</button>
                <button id="zoomOut" type="button">‚àí</button>
                <button id="exportCoordinates" type="button" title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î" style="display:none">üíæ</button>
              </div>
              <div id="mapViewport" class="map-viewport">
                <div id="mapContent" class="map-content">
                  <div id="mapMarkers" class="map-grid"></div>
                </div>
                <div id="touchInstruction" class="touch-instruction hidden">
                  <div class="touch-instruction__content">
                    <span class="touch-instruction__icon">üëÜüëÜ</span>
                    <span class="touch-instruction__text">‡πÉ‡∏ä‡πâ 2 ‡∏ô‡∏¥‡πâ‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏ã‡∏π‡∏°</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="card district-sidebar">
            <div class="card__header">
              <h2>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‡∏™.‡∏™.‡πÄ‡∏Ç‡∏ï</h2>
              <p>‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á</p>
            </div>
            <div class="top3-panel">
              <h3 id="top3Title">Top 3 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
              <div id="top3List" class="top3-list">
                <div class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï</div>
              </div>
            </div>
            <div class="party-seats-header">
              <span>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</span>
              <span>‡∏û‡∏£‡∏£‡∏Ñ</span>
              <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‡∏™.‡∏™.‡πÄ‡∏Ç‡∏ï</span>
            </div>
            <div class="party-votes-list" id="partyVotesList"></div>
            <!-- Hidden filters for JS compatibility -->
            <select id="provinceFilter" style="display:none"></select>
            <select id="partyFilter" style="display:none"></select>
            <input id="districtSearch" type="hidden" />
          </div>
        </div>
      </section>

      <section class="panel" id="partylist">
        <div class="partylist-container">
          <div class="card partylist-card">
            <div class="card__header">
              <h2>‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</h2>
              <div class="partylist-legend">
                <span class="legend-label">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</span>
                <span class="legend-label"></span>
                <span class="legend-label"></span>
                <span class="legend-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ‡∏™.‡∏™.‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</span>
                <span class="legend-label"></span>
              </div>
            </div>
            <div class="partylist-grid" id="partyListTable"></div>
          </div>
        </div>
      </section>

      <section class="panel" id="coalition">
        <div class="grid">
          <div class="card span-2">
            <div class="card__header">
              <h2>‡∏•‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏±‡∏ê‡∏ö‡∏≤‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h2>
              <p>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏£‡∏£‡∏Ñ ‚Ä¢ ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 250 ‡πÄ‡∏™‡∏µ‡∏¢‡∏á</p>
            </div>
            <div class="party-picker" id="coalitionList"></div>
          </div>
          <div class="card">
            <div class="card__header">
              <h2>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏£‡∏ß‡∏°</h2>
              <p>‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 250 ‡πÄ‡∏™‡∏µ‡∏¢‡∏á</p>
            </div>
            <div class="coalition-score">
              <strong id="coalitionTotal">0</strong>
              <span>‡πÄ‡∏™‡∏µ‡∏¢‡∏á</span>
            </div>
            <p class="status" id="coalitionStatus">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏∂‡∏á 250 ‡πÄ‡∏™‡∏µ‡∏¢‡∏á</p>
            <div class="coalition-tags" id="coalitionTags"></div>
          </div>
        </div>
      </section>

      <section class="panel" id="input">
        <div class="grid">
          <div class="card span-2">
            <div class="card__header">
              <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡πÄ‡∏Ç‡∏ï</h2>
              <p>‡πÉ‡∏ä‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö <a href="https://docs.google.com/spreadsheets/d/19cLkQfXtcwbnVFR6ilNd7ZeqRTUYU2jrmCCRsyFJ61w/edit?gid=0#gid=0" target="_blank" class="sheet-link">Google Sheet ‡∏ô‡∏µ‡πâ</a></p>
            </div>
            <div class="input-actions">
              <button id="importFromSheet">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å Google Sheet</button>
              <button id="downloadTemplate">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï CSV</button>
              <label class="upload">
                <input type="file" id="csvUpload" accept=".csv" />
                ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î CSV
              </label>
              <button id="applyCsv">‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÉ‡∏ä‡πâ</button>
            </div>
            <div id="districtImportProgress" class="import-progress hidden">
              <div class="import-progress__steps">
                <span class="step" data-step="1">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 1/3</span>
                <span class="step-label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
              </div>
              <div class="import-progress__bar">
                <div class="import-progress__fill"></div>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>‡∏†‡∏≤‡∏Ñ</th>
                    <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                    <th>‡πÄ‡∏Ç‡∏ï</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th>‡∏û‡∏£‡∏£‡∏Ñ 2569</th>
                    <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                  </tr>
                </thead>
                <tbody id="inputTable"></tbody>
              </table>
            </div>
          </div>
          <div class="card">
            <div class="card__header">
              <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</h2>
              <p>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å <a href="https://docs.google.com/spreadsheets/d/19cLkQfXtcwbnVFR6ilNd7ZeqRTUYU2jrmCCRsyFJ61w/edit?gid=170759107#gid=170759107" target="_blank" class="sheet-link">‡πÅ‡∏ó‡πá‡∏ö ‡∏™‡∏™ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</a></p>
            </div>
            <div class="input-actions">
              <button id="importPartyListFromSheet">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏à‡∏≤‡∏Å Google Sheet</button>
              <button id="downloadPartyListTemplate">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏•‡∏ï CSV</button>
              <label class="upload">
                <input type="file" id="partyListUpload" accept=".csv" />
                ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î CSV
              </label>
              <button id="addPartyRow">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏£‡∏£‡∏Ñ</button>
            </div>
            <div id="partyListImportProgress" class="import-progress hidden">
              <div class="import-progress__steps">
                <span class="step" data-step="1">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 1/3</span>
                <span class="step-label">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
              </div>
              <div class="import-progress__bar">
                <div class="import-progress__fill"></div>
              </div>
            </div>
            <div class="table-wrap">
              <table>
                <thead>
                  <tr>
                    <th>‡∏û‡∏£‡∏£‡∏Ñ</th>
                    <th>‡∏ó‡∏µ‡πà‡∏ô‡∏±‡πà‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠</th>
                  </tr>
                </thead>
                <tbody id="partyListInputTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- Party Winners Modal -->
    <div id="partyWinnersModal" class="modal-overlay hidden">
      <div class="modal-content">
        <button class="modal-close" id="modalClose" aria-label="Close">&times;</button>
        <div class="modal-header">
          <div class="modal-party-logo" id="modalPartyLogo"></div>
          <h2 class="modal-title">‡∏ú‡∏π‡πâ‡∏ä‡∏ô‡∏∞‡∏à‡∏≤‡∏Å‡∏û‡∏£‡∏£‡∏Ñ</h2>
          <span class="modal-count"></span>
        </div>
        <div class="modal-body">
          <table class="modal-table">
            <thead>
              <tr>
                <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                <th>‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</th>
                <th>‡πÄ‡∏Ç‡∏ï</th>
                <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
              </tr>
            </thead>
            <tbody id="modalWinnersList"></tbody>
          </table>
        </div>
      </div>
    </div>

    <div id="tooltip" class="tooltip" role="tooltip"></div>

    <script>
      // Cache-busting: Load JS with timestamp to always get fresh version
      const v = Date.now();
      document.write('<script src="data/results.js?v=' + v + '"><\/script>');
      document.write('<script src="app.js?v=' + v + '"><\/script>');
    </script>
  </body>
</html>
